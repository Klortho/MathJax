/*
 *  /MathJax/extensions/MathZoom.js
 *  
 *  Copyright (c) 2012 Design Science, Inc.
 *
 *  Part of the MathJax library.
 *  See http://www.mathjax.org for details.
 * 
 *  Licensed under the Apache License, Version 2.0;
 *  you may not use this file except in compliance with the License.
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 */

(function(a,d,f,c,j){var k="2.3-pmc";var i=a.CombineConfig("MathZoom",{styles:{"#MathJax_Zoom":{position:"absolute","background-color":"#F0F0F0",overflow:"auto",display:"block","z-index":301,padding:".5em",border:"1px solid black",margin:0,"font-weight":"normal","font-style":"normal","text-align":"left","text-indent":0,"text-transform":"none","line-height":"normal","letter-spacing":"normal","word-spacing":"normal","word-wrap":"normal","white-space":"nowrap","float":"none","box-shadow":"5px 5px 15px #AAAAAA","-webkit-box-shadow":"5px 5px 15px #AAAAAA","-moz-box-shadow":"5px 5px 15px #AAAAAA","-khtml-box-shadow":"5px 5px 15px #AAAAAA",filter:"progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')"},"#MathJax_ZoomOverlay":{position:"absolute",left:0,top:0,"z-index":300,display:"inline-block",width:"100%",height:"100%",border:0,padding:0,margin:0,"background-color":"white",opacity:0,filter:"alpha(opacity=0)"},"#MathJax_ZoomFrame":{position:"relative",display:"inline-block",height:0,width:0},"#MathJax_ZoomEventTrap":{position:"absolute",left:0,top:0,"z-index":302,display:"inline-block",border:0,padding:0,margin:0,"background-color":"white",opacity:0,filter:"alpha(opacity=0)"}},bodyDiv:false});var e,b,g;MathJax.Hub.Register.StartupHook("MathEvents Ready",function(){g=MathJax.Extension.MathEvents.Event;e=MathJax.Extension.MathEvents.Event.False;b=MathJax.Extension.MathEvents.Hover});var h=MathJax.Extension.MathZoom={version:k,settings:a.config.menuSettings,scrollSize:18,HandleEvent:function(n,l,m){if(h.settings.CTRL&&!n.ctrlKey){return true}if(h.settings.ALT&&!n.altKey){return true}if(h.settings.CMD&&!n.metaKey){return true}if(h.settings.Shift&&!n.shiftKey){return true}if(!h[l]){return true}return h[l](n,m)},Click:function(m,l){if(this.settings.zoom==="Click"){return this.Zoom(m,l)}},DblClick:function(m,l){if(this.settings.zoom==="Double-Click"||this.settings.zoom==="DoubleClick"){return this.Zoom(m,l)}},Hover:function(m,l){if(this.settings.zoom==="Hover"){this.Zoom(m,l);return true}return false},Zoom:function(o,v){this.Remove();b.ClearHoverTimer();g.ClearSelection();var t=MathJax.OutputJax[v.jaxID];var p=t.getJaxFromMath(v);if(p.hover){b.UnHover(p)}var l=Math.floor(document.body.clientWidth-100),u=Math.floor(Math.max(document.body.clientHeight,document.documentElement.clientHeight)-100);var n=d.Element("span",{id:"MathJax_ZoomFrame"},[["span",{id:"MathJax_ZoomOverlay",onmousedown:this.Remove}],["span",{id:"MathJax_Zoom",onclick:this.Remove,style:{visibility:"hidden",fontSize:this.settings.zscale,"max-width":l+"px","max-height":u+"px"}},[["span",{style:{display:"inline-block","white-space":"nowrap"}}]]]]);var A=n.lastChild,x=A.firstChild,q=n.firstChild;if(i.bodyDiv){n.setAttribute("data-mathdiv-id",v.getAttribute("id"));n.style.position="absolute";this.WrapperDiv().appendChild(n)}else{v.parentNode.insertBefore(n,v);v.parentNode.insertBefore(v,n)}if(x.addEventListener){x.addEventListener("mousedown",this.Remove,true)}if(this.msieTrapEventBug){var z=d.Element("span",{id:"MathJax_ZoomEventTrap",onmousedown:this.Remove});n.insertBefore(z,A)}if(this.msieZIndexBug){var w=d.addElement(document.body,"img",{src:"about:blank",id:"MathJax_ZoomTracker",width:0,height:0,style:{width:0,height:0,position:"relative"}});n.style.zIndex=i.styles["#MathJax_ZoomOverlay"]["z-index"];n=w}var y=t.Zoom(p,x,v,l,u);if(this.msiePositionBug){if(this.msieSizeBug){A.style.height=y.zH+"px";A.style.width=y.zW+"px"}if(A.offsetHeight>u){A.style.height=u+"px";A.style.width=(y.zW+this.scrollSize)+"px"}if(A.offsetWidth>l){A.style.width=l+"px";A.style.height=(y.zH+this.scrollSize)+"px"}}if(this.operaPositionBug){A.style.width=Math.min(l,y.zW)+"px"}var r=A.getElementsByTagName("svg")[0];if(r&&(MathJax.Hub.Browser.isChrome||MathJax.Hub.Browser.isSafari)){var m=window.getComputedStyle(A),s=parseInt(m.getPropertyValue("border-left-width"))+parseInt(m.getPropertyValue("padding-left"))+parseInt(m.getPropertyValue("padding-right"))+parseInt(m.getPropertyValue("border-right-width"));if(A.offsetWidth==s){A.style.width=r.offsetWidth+"px"}}this.Position(A,y,v);if(this.msieTrapEventBug){z.style.height=A.clientHeight+"px";z.style.width=A.clientWidth+"px";z.style.left=(parseFloat(A.style.left)+A.clientLeft)+"px";z.style.top=(parseFloat(A.style.top)+A.clientTop)+"px"}A.style.visibility="";if(this.settings.zoom==="Hover"){q.onmouseover=this.Remove}if(window.addEventListener){addEventListener("resize",this.Resize,false)}else{if(window.attachEvent){attachEvent("onresize",this.Resize)}else{this.onresize=window.onresize;window.onresize=this.Resize}}a.signal.Post(["math zoomed",p]);return e(o)},WrapperDiv:function(){var m="MathJax_ZoomWrapper";if(!this.hasOwnProperty("wrapperDiv")){var l=document.getElementById(m);if(!l){l=d.Element("div",{id:"MathJax_ZoomWrapper",style:{position:"absolute",top:"0px",left:"0px"}});if(!document.body.firstChild){document.body.appendChild(l)}else{document.body.insertBefore(l,null)}}this.wrapperDiv=l}return this.wrapperDiv},Position:function(m,n,u){var p=this.Resize(),F=p.x,D=p.y,s=n.mW;var H=-s-Math.floor((m.offsetWidth-s)/2),G=n.Y;if(!i.bodyDiv){m.style.left=Math.max(H,10-F)+"px";m.style.top=Math.max(G,10-D)+"px";console.info("left: "+m.style.left+", top: "+m.style.top)}else{var v=jQuery;var C=v(u),L=C.offset(),E=L.left,B=E+Math.floor(n.mW/2),q=B-Math.floor(m.offsetWidth/2),P=document.body.clientWidth,M=Math.floor(Math.min(10,(P-m.offsetWidth)/2)),I=P-M-m.offsetWidth,r=Math.min(Math.max(q,M),I);m.style.left=r+"px";var l=C.find("span.math");var z=l.length?Math.min(L.top,l.offset().top):L.top;var w=l.length?Math.max(n.mH,l.height()):n.mH;var A=z+Math.floor(w/2),t=A-Math.floor(m.offsetHeight/2),O=v(document).scrollTop(),N=v(window).height(),K=Math.floor(Math.min(10,(N-m.offsetHeight)/2)),o=O+N-K-m.offsetHeight,J=Math.min(Math.max(t,O+K),o);m.style.top=J+"px"}if(!h.msiePositionBug){h.SetWH()}},Resize:function(m){if(h.onresize){h.onresize(m)}var r=document.getElementById("MathJax_ZoomFrame"),l=document.getElementById("MathJax_ZoomOverlay");var o=h.getXY(r);var n=r.parentNode,q=h.getOverflow(n);while(n.parentNode&&n!==document.body&&q==="visible"){n=n.parentNode;q=h.getOverflow(n)}if(q!=="visible"){l.scroll_parent=n;var p=h.getXY(n);o.x-=p.x;o.y-=p.y;p=h.getBorder(n);o.x-=p.x;o.y-=p.y}l.style.left=(-o.x)+"px";l.style.top=(-o.y)+"px";if(h.msiePositionBug){setTimeout(h.SetWH,0)}else{h.SetWH()}return o},SetWH:function(){var l=document.getElementById("MathJax_ZoomOverlay");l.style.width=l.style.height="1px";var m=l.scroll_parent||document.documentElement||document.body;l.style.width=m.scrollWidth+"px";l.style.height=Math.max(m.clientHeight,m.scrollHeight)+"px"},getOverflow:(window.getComputedStyle?function(l){return getComputedStyle(l).overflow}:function(l){return(l.currentStyle||{overflow:"visible"}).overflow}),getBorder:function(o){var m={thin:1,medium:2,thick:3};var n=(window.getComputedStyle?getComputedStyle(o):(o.currentStyle||{borderLeftWidth:0,borderTopWidth:0}));var l=n.borderLeftWidth,p=n.borderTopWidth;if(m[l]){l=m[l]}else{l=parseInt(l)}if(m[p]){p=m[p]}else{p=parseInt(p)}return{x:l,y:p}},getXY:function(o){var l=0,n=0,m;m=o;while(m.offsetParent){l+=m.offsetLeft;m=m.offsetParent}if(h.operaPositionBug){o.style.border="1px solid"}m=o;while(m.offsetParent){n+=m.offsetTop;m=m.offsetParent}if(h.operaPositionBug){o.style.border=""}return{x:l,y:n}},Remove:function(p){var r=document.getElementById("MathJax_ZoomFrame");if(r){if(!i.bodyDiv){var q=MathJax.OutputJax[r.previousSibling.jaxID];var l=q.getJaxFromMath(r.previousSibling)}else{var o=r.getAttribute("data-mathdiv-id");var m=document.getElementById(o);var q=MathJax.OutputJax[m.jaxID];var l=q.getJaxFromMath(m)}a.signal.Post(["math unzoomed",l]);r.parentNode.removeChild(r);r=document.getElementById("MathJax_ZoomTracker");if(r){r.parentNode.removeChild(r)}if(h.operaRefreshBug){var n=d.addElement(document.body,"div",{style:{position:"fixed",left:0,top:0,width:"100%",height:"100%",backgroundColor:"white",opacity:0},id:"MathJax_OperaDiv"});document.body.removeChild(n)}if(window.removeEventListener){removeEventListener("resize",h.Resize,false)}else{if(window.detachEvent){detachEvent("onresize",h.Resize)}else{window.onresize=h.onresize;delete h.onresize}}}return e(p)}};a.Browser.Select({MSIE:function(l){var n=(document.documentMode||0);var m=(n>=9);h.msiePositionBug=!m;h.msieSizeBug=l.versionAtLeast("7.0")&&(!document.documentMode||n===7||n===8);h.msieZIndexBug=(n<=7);h.msieInlineBlockAlignBug=(n<=7);h.msieTrapEventBug=!window.addEventListener;if(document.compatMode==="BackCompat"){h.scrollSize=52}if(m){delete i.styles["#MathJax_Zoom"].filter}},Opera:function(l){h.operaPositionBug=true;h.operaRefreshBug=true}});h.topImg=(h.msieInlineBlockAlignBug?d.Element("img",{style:{width:0,height:0,position:"relative"},src:"about:blank"}):d.Element("span",{style:{width:0,height:0,display:"inline-block"}}));if(h.operaPositionBug||h.msieTopBug){h.topImg.style.border="1px solid"}MathJax.Callback.Queue(["StartupHook",MathJax.Hub.Register,"Begin Styles",{}],["Styles",f,i.styles],["Post",a.Startup.signal,"MathZoom Ready"],["loadComplete",f,"[MathJax]/extensions/MathZoom.js"])})(MathJax.Hub,MathJax.HTML,MathJax.Ajax,MathJax.OutputJax["HTML-CSS"],MathJax.OutputJax.NativeMML);

